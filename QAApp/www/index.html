<!DOCTYPE html>
<html style="height: 100%; width: 100%">
	<head>
		<title>My Bible QA App</title>
		<script type="text/javascript" src="lib/TweenMax.js"></script>
		<script type="text/javascript" src="lib/aes.js"></script>
		<script type="text/javascript" src="ViewNavigator.js"></script>
		<script type="text/javascript" src="ViewLibrary.js"></script>
		<script type="text/javascript" src="QueueViewModel.js"></script>
		<script type="text/javascript" src="AnswerViewModel.js"></script>
		<script type="text/javascript" src="RolesViewModel.js"></script>
		<script type="text/javascript" src="RolesTable.js"></script>
		<script type="text/javascript" src="ButtonRow.js"></script>
		<script type="text/javascript" src="FormRow.js"></script>
		<script type="text/javascript" src="RoleForms.js"></script>
		<script type="text/javascript" src="HttpClient.js"></script>
		<script type="text/javascript" src="AuthClient.js"></script>
		<script type="text/javascript" src="CurrentState.js"></script>
		<script type="text/javascript">
			function onLoad() {
				
				TRANSITION = { EVENT: 'transition', IMMEDIATE: 'immediate', SLIDE_LEFT: 'slide-left', SLIDE_RIGHT: 'slide-right' };
				viewNavigator = new ViewNavigator();
				
				var authClient = viewNavigator.httpClient.authClient;
				authClient.clearCredentials();// Keep for Testing
				if (authClient.hasCredentials()) {
					var credentials = authClient.getCredentials();
					viewNavigator.currentState.teacherId = credentials.user;
					viewNavigator.transition('splashView', 'queueView', 'openQuestionCount', TRANSITION.IMMEDIATE);
				} else {
					viewNavigator.transition('splashView', 'loginView', null, TRANSITION.IMMEDIATE);
				}
			}
			function processPassPhrase() {
				var node = document.getElementById('passPhraseNode');
				var passPhrase = node.value;
				console.log('PASS PHRASE', passPhrase);
				if (passPhrase) {
				var authClient = viewNavigator.httpClient.authClient;
					authClient.login(passPhrase, function(err) {
						if (err) {
							window.alert('Failure to Login: ' + err.message);
						} else {
							var credentials = authClient.getCredentials();
							viewNavigator.currentState.teacherId = credentials.user;
							window.alert('You are now permanently logged in on this device.');
							viewNavigator.transition('loginView', 'queueView', 'openQuestionCount', TRANSITION.SLIDE_LEFT);
						}
					});
				}
			}
			//function transitionToForgotView() {
			//	viewNavigator.transition('loginView', 'forgotView', null, TRANSITION.SLIDE_LEFT);
			//}
			//function transitionBackToLoginView() {
			//	viewNavigator.transition('forgotView', 'loginView', null, TRANSITION.SLIDE_RIGHT);
			//}
			//function openQuestionCount() {
			//	viewNavigator.transition('loginView', 'queueView', 'openQuestionCount', TRANSITION.SLIDE_LEFT);
			//}
			function assignQuestion(versionId) {
				viewNavigator.currentState.versionId = versionId;
				viewNavigator.transition('queueView', 'answerView', 'assignQuestion', TRANSITION.SLIDE_LEFT);
			}
			function returnQuestion() {
				viewNavigator.transition('answerView', 'queueView', 'returnQuestion', TRANSITION.SLIDE_RIGHT);
			}
			function anotherQuestion() {
				viewNavigator.transition('answerView', 'answerView', 'anotherQuestion', TRANSITION.IMMEDIATE);// is this needed, or shoudl it be like safe draft
			}
			function saveDraft() {
				viewNavigator.saveDraft();
			}
			function sendAnswer() {
				viewNavigator.transition('answerView', 'queueView', 'sendAnswer', TRANSITION.SLIDE_RIGHT);
			}
			function presentRoles() {
				viewNavigator.transition('queueView', 'rolesView', 'presentRoles', TRANSITION.SLIDE_LEFT);
			}
			function allCheckboxesOff() {
				viewNavigator.allCheckboxesOff();
			}
			function registerNewPerson() {
				viewNavigator.registerNewPerson();
			}
			function roleBackToQueue() {
				viewNavigator.transition('rolesView', 'queueView', 'openQuestionCount', TRANSITION.SLIDE_RIGHT);
			}
		</script>
		<link rel="stylesheet" type="text/css" href="./Buttons.css">
		<link rel="stylesheet" type="text/css" href="./Fields.css">
	</head>
	<body onload="onLoad()" style="height: 100%; width: 100%; display: block, position: relative">
		<div id="splashView" style="position: absolute; background: white">
			<p>Hello World 1<p>
		</div>
	</body>
</html>
