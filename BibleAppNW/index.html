<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <meta charset="utf-8" />
	<meta name="format-detection" content="telephone=no" />
	<meta name="msapplication-tap-highlight" content="no" />
	<meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, 
		height=device-height, target-densitydpi=device-dpi" />
	<link rel="stylesheet" href="css/bible.css"/>
	<script type="text/javascript" src="js/BibleApp.js"></script>
	<script type="text/javascript">
		function onBodyLoad() {
			console.log('DEVICE IS READY **');
			//presentBook('WEB/043JHN.usx');
			presentBook('WEB/001GEN.usx');
		};
		function presentBook(filename) {
			var reader = new NodeFileReader();
			reader.readTextFile('application', 'usx/' + filename, readSuccessHandler, readFailedHandler);
		};
		function readSuccessHandler(data) {
			var parser = new USXParser();
			var usxNode = parser.readBook(data);
			//var html = usxNode.toHTML();
			//console.log(html);
			var dom = new DOMBuilder();
			var fragment = dom.toDOM(usxNode);

			var builder = new HTMLBuilder();
			var html2 = builder.toHTML(fragment);

			var bodyNodes = document.getElementsByTagName('body');
			bodyNodes[0].appendChild(fragment);

			var writer = new NodeFileWriter();
			writer.writeTextFile('application', 'usx/999test.html', html2, writeSuccessHandler, writeFailedHandler);
		};
		function readFailedHandler(err) {
			console.log(JSON.stringify(err));
		};
		function writeSuccessHandler() {
			console.log('write file success');
		}
		function writeFailedHandler(err) {
			console.log(JSON.stringify(err));
		}
	</script>
  </head>
  <body onload="onBodyLoad()">
  </body>
</html>